data=[0.88 ,0.85, 0.79, 0.86, 0.85, 0.83;
0.87, 0.92, 0.85, 0.83, 0.90, 0.80;
0.84, 0.78, 0.81, 0.80, 0.85, 0.83;
0.81, 0.86 ,0.90, 0.87, 0.78, 0.79];
[a,ni] = size(data);
n = ni*a;
X = data;
mX = mean(X, 2);
Xbar = mean(mX);
SSE =sum(sum( (X - mX).*(X - mX)));
SSA = (mX - Xbar)'* (mX - Xbar) *ni;
F = (SSA/(a-1))/(SSE/(n - a));
display(F);
alpha = 1 - fcdf(F, a - 1, n - a);
display(alpha);

X1 = [7.6, 8.2, 6.8, 5.8 ,6.9, 6.6, 6.3 ,7.7 ,6.0];
X2 = [6.7 ,8.1 ,9.4, 8.6, 7.8 ,7.7, 8.9 ,7.9, 8.3 ,8.7 ,7.1, 8.4];
X3 = [8.5, 9.7 ,10.1, 7.8 ,9.6 ,9.5];
n1 = size(X1,2);
n2 = size(X2,2);
n3 = size(X3,2);
a = 3;
n = n1 + n2 + n3;
meanX1 = mean(X1,2);
meanX2 = mean(X2,2);
meanX3 = mean(X3,2);
mX = (meanX1*n1 + meanX2*n2 + meanX3*n3)/n;
SSE = (X1 - meanX1)*(X1 - meanX1)' +  (X2 - meanX2)*(X2 - meanX2)' + (X3 - meanX3)*(X3 - meanX3)';
SSA  =  n1*(meanX1  - mX)^2 + n2*(meanX2  - mX)^2 + n3*(meanX3  - mX)^2;
F = (SSA/(a-1))/(SSE/(n - a));
display(F);
alpha = 1 - fcdf(F, a - 1, n - a);
display(alpha);

X =[0.71 2.20 2.25 2.20 4.04 2.71;
1.66 2.93 3.93 2.69 4.16 5.43;
2.01 3.08 5.08 3.54 4.42 6.38;
2.16 3.49 5.82 3.75 4.93 6.38;
2.42 4.11 5.84 3.83 5.49 8.32;
2.42 4.95 6.89 4.08 5.77 9.04;
2.56 5.16 8.50 4.27 5.86 9.56;
2.60 5.54 8.56 4.53 6.28 10.01;
3.31 5.68 9.44 5.32 6.97 10.08;
3.64 6.25 10.52 6.18 7.06 10.62;
3.74 7.25 13.46 6.22 7.78 13.80;
3.74 7.90 13.57 6.33 9.23 15.99;
4.39 8.85 14.76 6.97 9.34 17.90;
4.50 11.96 16.41 6.97 9.91 18.25;
5.07 15.54 16.96 7.52 13.46 19.32;
5.26 15.89 17.56 8.36 18.40 19.87;
8.15 18.30 22.82 11.65 23.89 21.60;
8.24 18.59 29.13 12.45 26.39 22.25];
t = size(X,1);
r = 2;
s = 3;
Xij = mean(X,1);
Xi = [mean(Xij([1 2 3]))  mean(Xij([4 5 6]))] ;
Xj = [mean(Xij([1 4]))  mean(Xij([2 5])) mean(Xij([3 6]))];    
mX = mean(Xij);
SSE = sum(sum((X - Xij).*(X - Xij)));
SSA = s*t*sum((Xi - mX)*(Xi - mX)');
SSB = r*t*sum((Xj - mX)*(Xj - mX)');
paddingXi = [Xi(1) Xi(1) Xi(1) Xi(2) Xi(2) Xi(2)];
paddingXj = [Xj(1) Xj(2) Xj(3) Xj(1) Xj(2) Xj(3)];
SSAB = t*sum((Xij - paddingXi -paddingXj + mX).^2);
FA = (SSA/(r-1))/(SSE/(r*s*(t-1)));
FB = (SSB/(s-1))/(SSE/(r*s*(t-1)));
FAB = (SSAB/((r-1)*(s-1)))/(SSE/(r*s*(t-1)));
display(FA);
display(FB);
display(FAB);
pA = 1 - fcdf(FA, r-1, r*s*(t-1));
display(pA);
pB = 1 - fcdf(FB, s-1, r*s*(t-1));
display(pB);
pAB = 1 - fcdf(FAB, (r-1)*(s-1), r*s*(t-1));
display(pAB);

X = [35.60, 0.81, 17.5, 3.5,6.15, 5.22, 1.81,  34.10, 0.91, 18.0, 3.7, 6.17, 5.36, 1.35,  32.65, 0.93, 16.5, 3.5,6.11, 5.26, 1.6;
 39.70, 0.86, 21.0, 6.8,5.82, 3.40, 9.10,40.70, 0.79, 22.0, 6.2,5.86, 3.46, 8.59,42.55, 0.93, 21.0, 6.1,5.88, 3.43, 9.28;
 35.30, 1.39, 14.0, 2.3,4.55, 5.21, 9.33 ,34.60, 1.38, 14.0, 1.7,4.60, 5.19, 9.21,36.15, 1.29, 13.5, 2.3,4.59, 4.96, 9.45;
 37.80, 0.50, 20.0, 5.8,4.17, 6.68, 5.09,40.55, 0.53, 19.0, 6.4,4.21, 6.64, 5.22 ,41.30, 0.47, 19.5, 6.2,4.16, 6.63, 5.21;
 35.85, 0.53, 17.0, 4.9,3.79, 5.34, 7.85 ,36.85, 0.48, 17.0, 5.0, 3.82, 5.30, 8.18 ,36.45, 0.37, 18.5, 4.8,3.82, 5.38, 7.74];
p = size(X,1);
ni = 3;
dim = size(X,2)/ ni;
Xp = (X(:,1:dim) + X(:,(dim+1) : (2*dim)) +X(:,(2*dim+1):(3*dim)))/ni;
mX = mean(Xp,1);
A = (X - [Xp Xp Xp]);
A = reshape(A',[dim,p*ni]);
A = A*A';
T = X - kron(ones(p,ni),mX);
T = reshape(T',[dim,p*ni]);
T = T*T';
W = det(A)/det(T);
display(W);



 



