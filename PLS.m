data =[0.00 0.23 0.00 0.00 0.00 0.74 0.03 98.7;
0.00 0.10 0.00 0.00 0.12 0.74 0.04 97.8;
0.00 0.00 0.00 0.10 0.12 0.74 0.04 96.6;
0.00 0.49 0.00 0.00 0.12 0.37 0.02 92.0;
0.00 0.00 0.00 0.62 0.12 0.18 0.08 86.6;
0.00 0.62 0.00 0.00 0.00 0.37 0.01 91.2;
0.17 0.27 0.10 0.38 0.00 0.00 0.08 81.9;
0.17 0.19 0.10 0.38 0.02 0.06 0.08 83.1;
0.17 0.21 0.10 0.38 0.00 0.06 0.08 82.4;
0.17 0.15 0.10 0.38 0.02 0.10 0.08 83.2;
0.21 0.36 0.12 0.25 0.00 0.00 0.06 81.4;
0.00 0.00 0.00 0.55 0.00 0.37 0.08 88.1];
[n,m] = size(data);
m = m -1;
X = data(:,1:m);
Y = data(:,m+1);
mX = mean(X, 1);
mY = mean(Y, 1);
varX = dot(X-mX,X-mX,1)/(n-1);
varY = dot(Y - mY, Y -mY, 1)/(n-1);
X_ = (X - mX) .* repmat((1./sqrt(varX)),n,1);
Y_ = (Y - mY) .*repmat((1./sqrt(varY)),n,1);
r = min(n - 1, m);
X_ = X_';
Y_ = Y_';
A = ones(m,r);
B = ones(1,r);
T = ones(n,r);
for i = 1:r
    M = X_*Y_';
    [U, S, V] = svd(M);
    w = U(:,1);
    v = V(:,1);
    t = X_'*w;
    a = X_*t / norm(t);
    b = Y_*t/ norm(t);
    T(:,i) = t;
    A(:,i) = a;
    B(:,i) = b;
    X_ = X_ - a*t';
    Y_ = Y_ - b*t';
end
sss= 1;
