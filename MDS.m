D = zeros(10,10);
D(2,1) = 137;
D(3,1:2) = [499 486];
D(4,1:3) = [741 728 242];
D(5,1:4) =[1046 1033 547 305];
D(6,1:5) = [1288 1275 789 547 242];
D(7,1:6) =[2326 2210 1724 1482 1177 935];
D(8,1:7) = [1451 1335 849 760 530 288 693];
D(9,1:8) = [1746 1630 1144 902 597 355 1290 643];
D(10,1:9) = [1187 1174 688 446 128 275 1210 563 630];
for i = 2:10
    D(1:i-1,i) =  D(i,1:i-1) ;
end

p = 0.8;
n = 10;
S = D.*D;
H = eye(n) -ones(n,n)/n;
S1 = mean(S,1);
S2 = mean(S,2);
S12 = mean(S2);
Sc = S - S1 -S2 + S12;
Gc = -0.5*Sc;
[U, T] = eig(Gc);
diagT = diag(T);
[diagT,idx] = sort(diagT,'descend');
U = U(:,idx);
idx  = diagT > 0 ;
diagT = diagT(idx);
U = U(:,idx);
Y = U*diag(sqrt(diagT));
Y = Y';

C = zeros(10,10);
C(2,1) = 34;
C(3,1:2) = [79 54];
C(4,1:3) = [86 56 70];
C(5,1:4) =[76 30 51 66];
C(6,1:5) =[63 40 37 90 35];
C(7,1:6) =[57 86 77 50 76 77];
C(8,1:7) =[62 80 71 88 67 54 66];
C(9,1:8) =[65 23 69 66 22 35 76 71];
C(10, 1:9) =[26 60 70 89 63 67 59 33 59];
for i = 2:10
    C(1:i-1,i) =  C(i,1:i-1) ;
end

p = 0.8;
n = 10;
S = C.*C;
H = eye(n) -ones(n,n)/n;
S1 = mean(S,1);
S2 = mean(S,2);
S12 = mean(S2);
Sc = S - S1 -S2 + S12;
Gc = -0.5*Sc;
[U, T] = eig(Gc);
diagT = diag(T);
[diagT,idx] = sort(diagT,'descend');
U = U(:,idx);   
idx  = diagT > 0.001 ;
diagT = diagT(idx);
U = U(:,idx);
Y2 = U*diag(sqrt(diagT));
Y2 = Y2';
